const t="    ",e="\n",i="₀",s="₁",a="₂",n=`N x 2 array of node, neighbor${e+e}e.g.,${e}[${e+t}[1, 2]${e+t}[2, 3]${e+t}[4, 2]${e}]`,r=`N x 3 array of weight, node, neighbor${e+e}e.g.,${e}[${e+t}[2, 1, 2]${e+t}[4, 2, 3]${e+t}[1, 4, 2]${e}]`,h=`N x N matrix where matrix[row][col] defines edge between row and col${e+e}e.g.,${e}[${e+t}[0, 1, 0, 1]${e+t}[0, 1, 1, 0]${e+t}[1, 0, 0, 0]${e}]`,o=`1D array where elements are sorted in level order traversal d${i},d${s},d${s},d${a},d${a},d${a},d${a}${e+e}e.g.,${e+e}[0, 1, 1, 2, 2, 2, 2]`,l=`1D array of length n where i${i} is the stack bottom and iₙ₋₁ is the stack top${e+e}e.g.,${e+e}[6, 5, 4, 3 ,2, 1]`,d=`1D array of length n where i${i} is the queue front and iₙ₋₁ is the queue back${e+e}e.g.,${e+e}[1, 2, 3, 4, 5, 6]`,c=`1D array of length n where i${i} is the list head and iₙ₋₁ is the list tail${e+e}e.g.,${e+e}[0, 2, 4, 6, 8, 10]`;class g{constructor(t,e,i,s=void 0){this.name=t,this.desc=e,this.placeholder=i,this.placeholder2=s}findPlaceholder(t){return t&&this.placeholder2?this.placeholder2:this.placeholder}}const u=new class{constructor(){this.setDefaults()}setDefaults(){this.graph={adjacency_list:new g("adjacency_list","Adjacency List",n,r),adjacency_matrix:new g("adjacency_matrix","Adjacency Matrix",h)},this.tree={tree_array:new g("tree_array","Array",o)},this.stack={stack_array:new g("stack_array","Array",l)},this.queue={queue_array:new g("queue_array","Array",d)},this.linkedlist={linkedlist_array:new g("linkedlist_array","Array",c)}}},p=new class{constructor(){this.CanvasBgColor="#212529",this.EdgeColor="#EEEEEE",this.NodeColor="#141824",this.NodeFontSize="16px",this.NodeFontFamily="monospace",this.NodeFontColor="#EEEEEE",this.ArrowheadSize=10}};const m=new class{constructor(){this.setDefaultOptions(),this.getForms(),this.bindForms()}setDefaultOptions(){this.userOptions={graph:{directed:!1,weighted:!1},tree:{binary:!1,nary:!1,nulls:!1},stack:{},queue:{},linkedlist:{doubly:!1}}}getForms(){this.textarea=document.getElementById("dataset-textarea"),this.dsaSelectionText=document.querySelector(".dataset-dropdown-text"),this.graphControls=document.getElementById("graph-options-panel"),this.treeControls=document.getElementById("tree-options-panel"),this.linkedlistControls=document.getElementById("linkedlist-options-panel"),this.weightedSwitch=document.getElementById("weighted_switch"),this.directedSwitch=document.getElementById("directed-switch"),this.bstSwitch=document.getElementById("bst_switch"),this.narySwitch=document.getElementById("nary-switch"),this.nullsSwitch=document.getElementById("nulls-switch"),this.doublySwitch=document.getElementById("doubly_switch")}bindForms(){document.querySelector(".dropdown-menu").addEventListener("click",this.dropdownItemSelected.bind(this)),this.weightedSwitch.addEventListener("change",(t=>{this.userOptions.graph.weighted=t.target.checked})),this.directedSwitch.addEventListener("change",(t=>{this.userOptions.graph.directed=t.target.checked})),this.bstSwitch.addEventListener("change",(t=>{this.userOptions.tree.binary=t.target.checked})),this.narySwitch.addEventListener("change",(t=>{this.userOptions.tree.nary=t.target.checked})),this.nullsSwitch.addEventListener("change",(t=>{this.userOptions.tree.nulls=t.target.checked}))}toggleControls(t){let e="graph"!=t,i="linkedlist"!=t,s="tree"!=t;this.graphControls.classList.toggle("hide-opts-panel",e),this.linkedlistControls.classList.toggle("hide-opts-panel",i),this.treeControls.classList.toggle("hide-opts-panel",s)}dropdownItemSelected(t){if(t.target.hasAttribute("dsinputtypeoption")){this.dsa=t.target.getAttribute("dstype"),this.dsaFormat=t.target.getAttribute("dsinputtype"),localStorage.setItem("dsa",this.dsa),localStorage.setItem("dsa-format",this.dsaFormat),m.dsaSelectionText&&(m.dsaSelectionText.innerText=t.target.innerText);let e=u[this.dsa][this.dsaFormat].findPlaceholder(this.userOptions.graph.weighted);this.textarea&&this.textarea.setAttribute("placeholder",e)}}};class y{static parse_input(t){let e=this.sanitize_input(t);if(this.validate_input(e)){let t=this.deserialize_input(e),i="",s=document.querySelector(".dataset-container .invalid-feedback"),a=document.querySelector("textarea#dataset-textarea");if(null==t)i="Malformed input data";else if("graph"==m.dsa){0==Array.isArray(t)&&(i="Input data is not a 2D array");for(let e of t)if(0==Array.isArray(e)){i="Input data is not a 2D array";break}if("adjacency_matrix"==m.dsaFormat){let e=t.length;for(let s of t)if(s.length!=e){i="Matrix is not square";break}return t}if("adjacency_list"==m.dsaFormat){let e=m.userOptions.graph.weighted?3:2;for(let s of t)if(s.length!=e){i=`Adjacency list is not N x ${e}`;break}}}return i?(s.innerText=i,a.classList.toggle("is-invalid",!0),a.classList.toggle("is-valid",!1),null):(s.innerText="",a.classList.toggle("is-invalid",!1),a.classList.toggle("is-valid",!0),t)}}static validate_input(t){return""!=t}static sanitize_input(t){return t.replace(/[\n\t\s;]/g,"")}static deserialize_input(t){let e=null;try{return e=JSON.parse(t),e}catch(t){return null}}}class w{constructor(t){this.val=t,this.point=null,this.r=NaN,this.neighbors=[]}}function*x(t){let e=t,i=t[0],s=t[t.length-1];for(let t=0;t<e.length-1;t++){let i={curr:e[t],next:e[t+1]};yield i}return{first:i,last:s,done:!0}}class _{constructor(){this.canvasBgColor=p.CanvasBgColor,this.maxCellSize=50,this.maxRadius=50,this.edgeColor=p.EdgeColor,this.nodeColor=p.NodeColor,this.nodeFontSize=p.NodeFontSize,this.nodeFontFamily=p.NodeFontFamily,this.nodeFontColor=p.NodeFontColor}}class f{constructor(t,e,i,s){this.x=t,this.y=e,this.w=i,this.h=s}static FromCartesian(t,e,i,s){return i&&s||console.error("Cannot convert Euclidian coordiante to Relative coordiate without plane dimensions"),new f(i/2+t,s/2-e,i,s)}static FromCartesianPoint(t){let e=t.w/2+t.x,i=t.h/2-t.y;return new f(e,i,t.w,t.h)}ToCartesian(){if(!this.w||!this.h)return void console.error("Cannot convert Relative coordiante to Euclidian coordinate without plane dimensions");let t=-1*(this.w/2-this.x),e=this.h/2-this.y;return new v(t,e,this.w,this.h)}}class v{constructor(t,e,i,s){this.x=t,this.y=e,this.w=i,this.h=s}static FromRelative(t,e,i,s){if(!i||!s)return void console.error("Cannot convert Relative coordinate to Cartesian coordinate without plane dimensions");return new v(-1*(i/2-t),s/2-e,i,s)}static FromRelativePoint(t){let e=t.w/2+t.x,i=t.h/2-t.y;return new v(e,i,t.w,t.h)}ToRelative(){if(!this.w||!this.h)return void console.error("Cannot convert Cartesian coordinate to Relative coordinate without plane dimensions");let t=this.w/2+this.x,e=this.h/2-this.y;return new f(t,e,this.w,this.h)}}class S{}S.SegmentLine=(t,e,i)=>{let s=[],a=e.x-t.x,n=e.y-t.y;for(let e=0;e<i+1;e++)s.push(new f(t.x+a*e/i,t.y+n*e/i,t.w,t.h));return s},S.RelativeSlope=(t,e)=>Math.abs((e.x-t.x)/(e.y-t.y)),S.CartesianSlope=(t,e)=>(e.y-t.y)/(e.x-t.x),S.DistanceRatio=(t,e,i)=>t/Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2)),S.FindPointOnLine=(t,e,i)=>{let s=(1-i)*t.x+i*e.x,a=(1-i)*t.y+i*e.y;return new f(s,a,t.w,t.h)},S.Midpoint=(t,e)=>new f((t.x+e.x)/2,(t.y+e.y)/2,t.w,t.h),S.RelativeDirection=t=>t<.5?"vertical":t>.5&&t<1.5?"diagonal":t>3?"horizontal":void 0;class C extends _{constructor(t,e){super(),this.dataset=[],this.matrix=[],this.graph={},this.weights=[],this.edgelist=[],this.unique_nodes=new Set,this.node_list=[],this.edges=[],this.radius=NaN,this.cell_size=NaN,this.grid_size=NaN,this.steps=50,this.current_edge=0,this.animation_frame_id=NaN,this.ctx=t,this.canvas=e}parse(t){switch(this.dataset=t,m.dsaFormat){case u.graph.adjacency_list.name:m.userOptions.graph.weighted?this.parse_weighted_adjacency_list():this.parse_adjacency_list();break;case u.graph.adjacency_matrix.name:this.parse_undirected_unweighted_adjacency_matrix()}this.cell_size=this.canvas.width/this.grid_size,this.radius=Math.min(this.maxRadius,.25*this.cell_size)}parse_adjacency_list(){this.unique_nodes=new Set(this.dataset.flatMap((t=>t))),this.node_list=Array.from(this.unique_nodes.values()).sort(((t,e)=>t-e)),this.edgelist=this.dataset,this.grid_size=Math.ceil(Math.sqrt(this.unique_nodes.size));for(let t=0;t<this.grid_size;t++)this.matrix.push(this.node_list.slice(t*this.grid_size,t*this.grid_size+this.grid_size).map((t=>new w(t))))}parse_weighted_adjacency_list(){this.unique_nodes=new Set(this.dataset.flatMap((t=>t.slice(1)))),this.node_list=Array.from(this.unique_nodes.values()).sort(((t,e)=>t-e)),this.grid_size=Math.ceil(Math.sqrt(this.unique_nodes.size));for(let t=0;t<this.grid_size;t++)this.matrix.push(this.node_list.slice(t*this.grid_size,t*this.grid_size+this.grid_size).map((t=>new w(t))));for(let t of this.dataset){let e=t[1]+"_"+t[2],i=t[2]+"_"+t[1];e in this.weights?this.weights[e].push(t[0]):i in this.weights?this.weights[i].push(t[0]):this.weights[e]=[t[0]]}}parse_undirected_unweighted_adjacency_matrix(){this.node_list=Array.from(Array(this.dataset.length).keys()).map((t=>t+1)),this.unique_nodes=new Set(this.node_list),this.grid_size=Math.ceil(Math.sqrt(this.unique_nodes.size));for(let t=0;t<this.dataset.length;t++)for(let e=t+1;e<this.dataset.length;e++)1==this.dataset[t][e]&&this.edgelist.push([t+1,e+1]);for(let t=0;t<this.grid_size;t++)this.matrix.push(this.node_list.slice(t*this.grid_size,t*this.grid_size+this.grid_size).map((t=>new w(t))))}plot(){switch(this.ctx.fillStyle=this.canvasBgColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),m.dsaFormat){case u.graph.adjacency_list.name:m.userOptions.graph.weighted?this.plotWeightedUndirectedGraph():this.plotUnweightedUndirectedGraph();break;case u.graph.adjacency_matrix.name:this.plotUnweightedUndirectedGraph()}}plot_nodes(){for(let t=0;t<this.matrix.length;t++)for(let e=0;e<this.matrix[t].length;e++){let i=Math.floor(21*Math.random()-10),s=Math.floor(21*Math.random()-10),a=this.cell_size*t+this.cell_size/2+i,n=this.cell_size*e+this.cell_size/2+s;this.matrix[t][e].point=new f(a,n,this.canvas.width,this.canvas.height),this.matrix[t][e].r=this.radius,this.graph[this.matrix[t][e].val]=this.matrix[t][e],this.ctx.beginPath(),this.ctx.fillStyle=this.nodeColor,this.ctx.arc(a,n,this.radius,0,2*Math.PI),this.ctx.fill(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.fillStyle=this.nodeFontColor,this.ctx.font=`${this.nodeFontSize} ${this.nodeFontFamily}`,this.ctx.textAlign="center",this.ctx.fillText(String(this.matrix[t][e].val),a,n+3),this.ctx.closePath()}}plotUnweightedUndirectedGraph(){this.plot_nodes();for(let[t,e]of this.edgelist){let i=this.graph[t],s=this.graph[e],a=S.DistanceRatio(this.radius,i.point,s.point),n=S.FindPointOnLine(i.point,s.point,a),r=S.FindPointOnLine(s.point,i.point,a);this.edges.push(x.bind(this)(S.SegmentLine(n,r,this.steps)))}this.animate_edges.bind(this),this.animate_edges()}plotWeightedUndirectedGraph(){this.plot_nodes();for(let[,t,e]of this.dataset){let i=this.graph[t],s=this.graph[e],a=t+"_"+e,n=e+"_"+t;if(0==this.weights[a].length&&0==this.weights[n].length)continue;let r=S.DistanceRatio(this.radius,i.point,s.point),h=S.FindPointOnLine(i.point,s.point,r),o=S.FindPointOnLine(s.point,i.point,r),l=S.Midpoint(i.point,s.point),d=this.format_edge_label(a,n),c=S.RelativeSlope(i.point,s.point),[g,u]=this.calc_label_offsets(c,d);this.edges.push(x.bind(this)(S.SegmentLine(h,o,this.steps))),this.ctx.beginPath(),this.ctx.fillStyle="#CCCCCC",this.ctx.font="10px monospace",this.ctx.textAlign="center",this.ctx.fillText(d,l.x+g,l.y+u),this.ctx.closePath()}this.animate_edges.bind(this),this.animate_edges()}format_edge_label(t,e){let i="";return(this.weights[t]||this.weights[e])&&(this.weights[t].length?i=this.weights[t].sort(((t,e)=>t-e)).join(", "):this.weights[e].length&&(i=this.weights[e].sort(((t,e)=>e-t)).join(",")),this.weights[t]=[],this.weights[e]=[]),i}calc_label_offsets(t,e){let i=0,s=0;return t<.5||t>.5&&t<1.5?i=e.length>1?-(e.length+10):-6:t>3&&(s=-3),[i,s]}animate_edges(){let t=this.edges[this.current_edge].next();if(0==t.done){let{curr:e,next:i}=t.value;this.animation_frame_id=requestAnimationFrame(this.animate_edges.bind(this)),this.ctx.beginPath(),this.ctx.strokeStyle=this.edgeColor,this.ctx.moveTo(e.x,e.y),this.ctx.lineTo(i.x,i.y),this.ctx.stroke()}if(1==t.done){let{first:e,last:i}=t.value;cancelAnimationFrame(this.animation_frame_id),this.ctx.closePath(),this.current_edge+=1;let s=i.ToCartesian(),a=30,n=S.CartesianSlope(e.ToCartesian(),i.ToCartesian()),r=s.x+p.ArrowheadSize*Math.cos(Math.atan(n)-a*(Math.PI/180)),h=s.y+p.ArrowheadSize*Math.sin(Math.atan(n)-a*(Math.PI/180)),o=f.FromCartesian(r,h,i.w,i.h),l=s.x+p.ArrowheadSize*Math.cos(Math.atan(n)+a*(Math.PI/180)),d=s.y+p.ArrowheadSize*Math.sin(Math.atan(n)+a*(Math.PI/180)),c=f.FromCartesian(l,d,i.w,i.h),g=S.DistanceRatio(p.ArrowheadSize,i,o),u=S.FindPointOnLine(i,o,g),m=S.FindPointOnLine(i,c,g),y=s.x-u.ToCartesian().x,w=s.y-u.ToCartesian().y,x=Math.sqrt(y*y+w*w),_=y/x*p.ArrowheadSize+s.x,v=w/x*p.ArrowheadSize+s.y,C=s.x-m.ToCartesian().x,b=s.y-m.ToCartesian().y,z=Math.sqrt(C*C+b*b),F=C/z*p.ArrowheadSize+s.x,M=b/z*p.ArrowheadSize+s.y,$=f.FromCartesian(_,v,this.canvas.width,this.canvas.height),E=f.FromCartesian(F,M,this.canvas.width,this.canvas.height),k=null,A=null;return i.y-e.y>0?Math.min($.y,E.y)<Math.min(u.y,m.y)?(k=$,A=E):(k=u,A=m):i.y-e.y<0&&(Math.max($.y,E.y)>Math.max(u.y,m.y)?(k=$,A=E):(k=u,A=m)),this.ctx.beginPath(),this.ctx.strokeStyle=this.edgeColor,this.ctx.moveTo(i.x,i.y),this.ctx.lineTo(k.x,k.y),this.ctx.stroke(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.strokeStyle=this.edgeColor,this.ctx.moveTo(i.x,i.y),this.ctx.lineTo(A.x,A.y),this.ctx.stroke(),void(this.current_edge<this.edges.length&&(this.animation_frame_id=requestAnimationFrame(this.animate_edges.bind(this))))}}}let b,z,F="graph",M="adjacency_list";function $(){m.dsaFormat&&function(){let t=m.textarea.value;if(y.validate_input(t)){let e=y.parse_input(t);if(null==e);else{localStorage.setItem("dsa-input",t),document.getElementById("idle-canvas-overlay").style.display="none",z.clearRect(0,0,b.width,b.height);let i=null;switch(M){case null:return;case u.graph.adjacency_list.name:case u.graph.adjacency_matrix.name:i=new C(z,b);break;default:return}i.parse(e,F,M),i.plot()}}}()}!function(){document.querySelector("#go-btn").addEventListener("click",$),function(){let t=[];for(let e in u){let i=document.createElement("li"),s=document.createElement("h6");s.innerText=e.slice(0,1).toUpperCase()+e.slice(1),s.className="dropdown-header";let a=document.createElement("hr");a.className="dropdown-divider",i.appendChild(s),t.push(i);for(let i in u[e]){let s=document.createElement("li"),a=document.createElement("a");a.className="dropdown-item",a.href="#",a.innerText=u[e][i].desc,a.setAttribute("dstype",e),a.setAttribute("dsinputtypeoption",""),a.setAttribute("dsinputtype",i),s.appendChild(a),t.push(s)}t.push(a)}let e=document.querySelector(".dropdown-menu");for(let i of t)e.appendChild(i)}();let t=document.querySelector(".content"),e=document.querySelector(".form-container");b=document.querySelector("canvas"),b.width=t.clientWidth-e.clientWidth-20,b.height=b.width,z=b.getContext("2d",{alpha:!1}),z.fillStyle=p.CanvasBgColor,z.fillRect(0,0,b.width,b.height);let i=localStorage.getItem("dsa-input"),s=localStorage.getItem("dsa"),a=localStorage.getItem("dsa-format");if(null!=i&&(m.textarea.value=i),null!=s&&null!=a){let t=document.querySelector(`a.dropdown-item[dstype=${s}][dsinputtype=${a}]`);t&&t.click()}}();
